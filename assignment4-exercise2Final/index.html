<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="module">
        import { Subject } from 'https://dev.jspm.io/rxjs@6/_esm2015';
        import { map, filter } from 'https://dev.jspm.io/rxjs@6/_esm2015/operators';
        import {Warnings} from "./index.js";

        let warnings
        let ws

        let warningsOn

        window.unSubscribe = () =>{
            ws.onopen = () => {
                const message = "unsubscribe"
                ws.send(message)
            }
        }

        window.warningsOnOff = () => {
            if(warningsOn===true){
                unSubscribe()
                document.getElementById("warnings").style.display = "none"
                warningsOn=false
            }else {
                location.reload()
                warningsOn=true
            }
        }

        window.load = () => {
            console.log("something")
            warnings = new Warnings()
            ws = new WebSocket("ws://localhost:8090/warnings")
            const subject = new Subject()
            warningsOn = true
            ws.onopen = () => {
                const message = "subscribe"
                ws.send(message)
                subject.subscribe(warnings.retrieveData)
            }
            ws.onmessage = message => {
                subject.next(message)
            }
        }
    </script>
</head>
<body onload="load()">
<div>
    <button onclick="warningsOnOff()">Warnings on/off</button>
</div>
<div>
    Warnings:<br>
    <ul id="warnings"></ul>
</div>
</body>
</html>